/*! For license information please see admin-controls.js.LICENSE.txt */
(()=>{"use strict";var e={192:(e,t,s)=>{var i=s(609),o=Symbol.for("react.element"),n=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),r=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,s){var i,l={},c=null,p=null;for(i in void 0!==s&&(c=""+s),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(p=t.ref),t)n.call(t,i)&&!a.hasOwnProperty(i)&&(l[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===l[i]&&(l[i]=t[i]);return{$$typeof:o,type:e,key:c,ref:p,props:l,_owner:r.current}}t.jsx=l,t.jsxs=l},540:(e,t,s)=>{e.exports=s(192)},609:e=>{e.exports=window.React}},t={},s=function s(i){var o=t[i];if(void 0!==o)return o.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,s),n.exports}(540);const{Button:i,ComboboxControl:o}=wp.components,{Component:n,Fragment:r}=wp.element,a=class extends n{constructor(e){super(e),this.state={items:[],isBusy:!1},this.fetchItems()}hasMeta(){return this.props.metaFields&&this.props.metaFields.length}fetchItems(){const e=[];if(this.props.relatedItems&&this.props.relatedItems.length)for(var t=0;t<this.props.relatedItems.length;t++)e.push(this.props.relatedItems[t].related_id);window.wp.ajax.send("jet_engine_relations_get_type_items",{type:"GET",data:{_nonce:window.JetEngineRelationsCommon._nonce,relID:this.props.relID,existing:e,objectType:this.props.controlObjectType,object:this.props.controlObjectName},success:e=>{this.setState({items:[...e]})},error:(e,t,s)=>{e.message?alert(e.message):alert(s)}})}render(){return(0,s.jsx)(r,{children:0<this.state.items.length&&(0,s.jsxs)(r,{children:[(0,s.jsx)(o,{value:this.state.relatedID,onChange:e=>{this.setState({relatedID:e})},label:this.props.labels.select,options:this.state.items}),(0,s.jsx)(i,{isPrimary:!0,isBusy:this.state.isBusy,disabled:!this.state.relatedID,onClick:()=>{this.setState({isBusy:!0}),this.props.onChange(this.state.relatedID)},children:this.props.labels.connectButton})]})})}},{Button:l}=wp.components,{MediaUpload:c,MediaUploadCheck:p}=wp.blockEditor,{Component:h,Fragment:d}=wp.element,{assign:m,castArray:u}=window.lodash;class j extends h{constructor(e){super(e),this.frame=wp.media({multiple:!1}),this.openModal=this.openModal.bind(this),this.onOpen=this.onOpen.bind(this),this.onSelect=this.onSelect.bind(this),this.onUpdate=this.onUpdate.bind(this),this.onClose=this.onClose.bind(this),this.frame.on("select",this.onSelect),this.frame.on("update",this.onUpdate),this.frame.on("open",this.onOpen),this.frame.on("close",this.onClose)}onSelect(){const e=this.frame.state().get("selection").toJSON();this.props.onSelect(e[0])}onUpdate(e){const t=this.frame.state(),s=e||t.get("selection");s&&s.models.length&&this.props.onSelect(s.models[0].toJSON())}onOpen(){if(this.updateCollection(),!this.props.value)return;const e=this.frame.state().get("selection");u(this.props.value).forEach((t=>{e.add(wp.media.attachment(t))}))}onClose(){this.props.onClose&&this.props.onClose()}updateCollection(){const e=this.frame.content.get();if(e&&e.collection){const t=e.collection;t.toArray().forEach((e=>e.trigger("destroy",e))),t.mirroring._hasMore=!0,t.more()}}openModal(){this.frame.open()}render(){return this.props.render({open:this.openModal})}componentWillUnmount(){this.frame.remove()}}const w=class extends h{constructor(e){super(e),this.state={value:this.props.value}}componentDidMount(){let e=!1;switch(this.props.value_format){case"both":this.props.value&&this.props.value.url&&this.setState({previewURL:this.props.value.url});break;case"url":this.props.value&&this.setState({previewURL:this.props.value});break;default:this.props.value&&(e=this.props.value)}e&&this.fetchImg(e)}mediaUploadRender(e){return(0,s.jsxs)("div",{style:{display:"flex",paddingTop:"5px",paddingBottom:"15px"},children:[(0,s.jsx)(l,{onClick:e,className:"is-nested-modal-trigger",isSecondary:!0,isSmall:!0,children:"Select or upload image"}),this.state.value&&(0,s.jsx)(l,{onClick:()=>{this.setState((e=>{const t=m({},e,{value:null,previewURL:null});return this.props.onChange(t.value),t}))},isDestructive:!0,isSmall:!0,style:{marginLeft:"5px"},children:"Reset"})]})}mediaUploadOnSelect(e){this.setState((t=>{var s={};switch(this.props.value_format){case"both":s=m({},t,{value:{id:e.id,url:e.url}});break;case"url":s=m({},t,{value:e.url});break;default:s=m({},t,{value:e.id})}return this.props.onChange(s.value),s})),this.setState({previewURL:e.url})}fetchImg(e){wp.apiFetch({method:"get",path:"/wp/v2/media/"+e}).then((e=>{this.setState({previewURL:e.media_details.sizes.thumbnail.source_url})}))}render(){return(0,s.jsxs)(d,{children:[(0,s.jsx)("div",{style:{paddingBottom:"10px"},children:(0,s.jsx)("b",{children:this.props.label})}),this.state.previewURL&&(0,s.jsx)("img",{src:this.state.previewURL,width:"150px",height:"auto"}),(0,s.jsx)(p,{fallback:(0,s.jsx)(j,{onSelect:e=>{this.mediaUploadOnSelect(e)},value:this.state.value,render:({open:e})=>this.mediaUploadRender(e)}),children:(0,s.jsx)(c,{onSelect:e=>{this.mediaUploadOnSelect(e)},value:this.state.value,render:({open:e})=>this.mediaUploadRender(e)})})]})}},{BaseControl:x,CheckboxControl:g}=wp.components,{Component:b,Fragment:v}=wp.element,{assign:y}=window.lodash,_=class extends b{constructor(e){super(e),this.state={value:this.props.value||[]}}render(){const{label:e,help:t,options:i,layout:o,onChange:n}=this.props;return(0,s.jsx)(x,{label:e,help:t,children:(0,s.jsx)("div",{className:"je-checkbox-group-"+o,children:i.map(((e,t)=>(0,s.jsx)(g,{label:e.label,checked:this.state.value.includes(e.value),onChange:()=>{const t=this.state.value;t.includes(e.value)?t.splice(t.indexOf(e.value),1):t.push(e.value),this.setState({value:t},(()=>{n(this.state.value)}))}},"check_"+e.value+t)))})})}},{Button:f,TextControl:C,TextareaControl:D,RadioControl:S,SelectControl:O}=wp.components,{Component:I,Fragment:T}=wp.element,{assign:P}=window.lodash,M=class extends I{constructor(e){super(e),this.props.values?this.state=P({},this.props.values):this.state={}}onChange(e,t){this.setState((s=>{const i=P({},s,{[e]:t});return this.props.onChange(i),i}))}fieldTemplate(e){const t={key:"field_"+e.type+e.name,label:e.title+(e.required?" *":""),help:e.description?(0,s.jsx)("span",{dangerouslySetInnerHTML:{__html:e.description}}):"",value:this.state[e.name],onChange:t=>{this.onChange(e.name,t)}},i=P({},e);i.class&&(i.className=i.class,delete i.class);let o,n=e.type;switch("text"===n&&e.input_type&&(n=e.input_type),-1!==["checkbox","radio"].indexOf(e.type)&&(o=e.layout||"vertical"),n){case"select":return(0,s.jsx)(O,{...t,options:e.options,multiple:e.multiple});case"radio":return parseInt(t.value,10)==t.value?t.selected=parseInt(t.value,10):t.selected=t.value,delete t.value,(0,s.jsx)(S,{className:"je-radio-group-"+o,...t,options:e.options});case"checkbox":return(0,s.jsx)(_,{...t,options:e.options,layout:o});case"media":return e.multi_upload?(0,s.jsx)("p",{children:(0,s.jsx)("i",{children:"Gallery field type is not supported"})}):(0,s.jsx)(w,{...t,...e});case"date":return(0,s.jsx)(C,{...t,type:"date"});case"time":return(0,s.jsx)(C,{...t,type:"time"});case"textarea":case"wysiwyg":return(0,s.jsx)(D,{...t});case"datetime-local":return(0,s.jsx)(C,{...t,type:"datetime-local"});case"switcher":case"iconpicker":case"repeater":case"colorpicker":case"posts":case"html":return(0,s.jsx)("p",{children:(0,s.jsx)("i",{children:n+" field type is not supported"})});default:return(0,s.jsx)(C,{...t})}}render(){return(0,s.jsx)(T,{children:this.props.fields.map((e=>this.fieldTemplate(e)))})}},{Button:B,ComboboxControl:N}=wp.components,{Component:F,Fragment:k}=wp.element,{assign:R}=window.lodash,L=class extends F{constructor(e){super(e),this.state={item:{},isBusy:!1}}createItem(){window.wp.ajax.send("jet_engine_relations_create_item_of_type",{type:"GET",data:{_nonce:window.JetEngineRelationsCommon._nonce,relID:this.props.relID,relatedObjectType:this.props.controlObjectType,relatedObjectName:this.props.controlObjectName,isParentProcessed:this.props.isParentProcessed,item:this.state.item},success:e=>{this.props.onChange(e.itemID),this.setState({isBusy:!1})},error:(e,t,s)=>{this.setState({isBusy:!1}),e?alert(e):alert(s)}})}render(){return(0,s.jsxs)(k,{children:[(0,s.jsx)(M,{fields:this.props.createFields,onChange:e=>{this.setState({item:R({},e)})}}),(0,s.jsx)(B,{isPrimary:!0,isBusy:this.state.isBusy,className:"jet-engine-rels__create-item",onClick:()=>{this.setState({isBusy:!0}),this.createItem()},children:this.props.labels.createButton})]})}},{Button:E,TextControl:U}=wp.components,{Component:z,Fragment:J}=wp.element,{assign:G,isEmpty:V}=window.lodash,H=class extends z{constructor(e){super(e);let t=this.props.value||{},s={};for(const e of this.props.metaFields)if(void 0!==e.value&&void 0!==e.name){let t=e.value;"checkbox"===e.type&&(t=Object.keys(e.value)),s[e.name]=t}this.state={metaData:G({},s,t),isBusy:!1,done:!1,error:!1,errorMessage:""},this.savedTimeout=null,this.errorTimeout=null}saveMeta(){window.wp.ajax.send("jet_engine_relations_save_relation_meta",{type:"POST",data:{_nonce:window.JetEngineRelationsCommon._nonce,relID:this.props.relID,relatedObjectID:this.props.relatedObjectID,relatedObjectType:this.props.controlObjectType,relatedObjectName:this.props.controlObjectName,currentObjectID:this.props.currentObjectID,isParentProcessed:this.props.isParentProcessed,meta:this.state.metaData},success:e=>{this.setState({isBusy:!1,done:!0}),this.savedTimeout=setTimeout((()=>{this.setState({done:!1})}),2e3),this.props.onUpdate()},error:(e,t,s)=>{e?alert(e):alert(s),this.setState({isBusy:!1,done:!1})}})}checkRequiredFields(){let e=[];for(const t of this.props.metaFields)if(t.required){let s=!1;s=void 0===this.state.metaData[t.name]||V(this.state.metaData[t.name]),s&&e.push(t.title)}return this.errorTimeout&&(clearTimeout(this.errorTimeout),this.errorTimeout=null),e.length?(this.setState({error:!0,errorMessage:"Empty required fields: "+e.join(", ")}),this.errorTimeout=setTimeout((()=>{this.setState({error:!1,errorMessage:""})}),3e3)):this.setState({error:!1,errorMessage:""}),e.length>0}render(){return(0,s.jsxs)(J,{children:[(0,s.jsx)(M,{fields:this.props.metaFields,values:this.state.metaData,onChange:e=>{this.setState({metaData:G({},e)})}}),(0,s.jsxs)("div",{className:"jet-engine-rels-popup__footer",children:[(0,s.jsx)(E,{isPrimary:!0,isBusy:this.state.isBusy,onClick:()=>{this.checkRequiredFields()||(this.setState({isBusy:!0}),this.savedTimeout&&(clearTimeout(this.savedTimeout),this.savedTimeout=null),this.saveMeta())},children:"Save Meta Data"}),this.state.error&&(0,s.jsx)("span",{style:{marginLeft:"10px",color:"red"},children:this.state.errorMessage}),this.state.isBusy&&(0,s.jsx)("span",{style:{marginLeft:"10px"},children:"Saving..."}),!this.state.isBusy&&this.state.done&&(0,s.jsx)("span",{style:{marginLeft:"10px",color:"green"},children:"Saved!"})]})]})}},{Modal:q,Button:A}=wp.components,{Component:W,Fragment:$}=wp.element,Y=class extends W{constructor(e){super(e),this.state={relatedObjectID:!1,relatedList:[],isBusy:!1}}processRelation(e){window.wp.ajax.send("jet_engine_relations_update_relation_items",{type:"POST",data:{_nonce:window.JetEngineRelationsCommon._nonce,relID:this.props.relID,relatedObjectID:e,relatedObjectType:this.props.controlObjectType,relatedObjectName:this.props.controlObjectName,isParentProcessed:this.props.isParentProcessed,currentObjectID:this.props.currentObjectID},success:t=>{this.hasMetaFields()?this.setState({relatedObjectID:e,relatedList:t.related_list}):this.props.onComplete(t.related_list),this.setState({isBusy:!1})},error:(e,t,s)=>{this.setState({isBusy:!1}),e?alert(e):alert(s)}})}hasMetaFields(){return this.props.metaFields&&0<this.props.metaFields.length}showMetaFields(){return this.state.relatedObjectID&&this.hasMetaFields()}modalTitle(){return this.showMetaFields()?"Edit Meta Fields":this.props.title}render(){const e={width:"760px",maxWidth:"80vw"};this.state.isBusy&&(e.opacity="0.9");const t=["jet-engine-rels-modal"];return this.showMetaFields()&&t.push("has-footer"),(0,s.jsxs)(q,{title:this.modalTitle(),style:e,className:t.join(" "),onRequestClose:e=>{e.target.classList.contains("is-nested-modal-trigger")||this.props.onClose(this.state.relatedList)},children:["create"===this.props.type&&!this.state.relatedObjectID&&(0,s.jsx)(L,{...this.props,onChange:e=>{this.setState({isBusy:!0}),this.processRelation(e)}}),"connect"===this.props.type&&!this.state.relatedObjectID&&(0,s.jsx)(a,{...this.props,onChange:e=>{this.setState({isBusy:!0}),this.processRelation(e)}}),this.showMetaFields()&&(0,s.jsx)(H,{...this.props,relatedObjectID:this.state.relatedObjectID,onUpdate:()=>{this.props.onComplete(this.state.relatedList)}})]})}},{SVG:K,Path:Q}=wp.components,X=(0,s.jsx)(K,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,s.jsx)(Q,{d:"M10 6c3.9 0 7-.9 7-2s-3.1-2-7-2-7 .9-7 2 3.1 2 7 2zm0 9c-3.9 0-7-.9-7-2v3c0 1.1 3.1 2 7 2s7-.9 7-2v-3c0 1.1-3.1 2-7 2zm0-4c-3.9 0-7-.9-7-2v3c0 1.1 3.1 2 7 2s7-.9 7-2V9c0 1.1-3.1 2-7 2zm0-4c-3.9 0-7-.9-7-2v3c0 1.1 3.1 2 7 2s7-.9 7-2V5c0 1.1-3.1 2-7 2z"})}),{Modal:Z,Button:ee}=wp.components,{Component:te,Fragment:se}=wp.element,{assign:ie}=window.lodash,oe=class extends te{constructor(e){super(e),this.state={showModal:!1,dataLoaded:!1,metaData:{}}}hasMeta(){return this.props.metaFields&&0<this.props.metaFields.length}fetchData(){window.wp.ajax.send("jet_engine_relations_get_related_item_meta",{type:"GET",data:{_nonce:window.JetEngineRelationsCommon._nonce,relID:this.props.relID,relatedObjectID:this.props.relatedObjectID,relatedObjectType:this.props.controlObjectType,relatedObjectName:this.props.controlObjectName,isParentProcessed:this.props.isParentProcessed,currentObjectID:this.props.currentObjectID},success:e=>{e&&this.setState({metaData:ie({},e)}),this.setState({dataLoaded:!0})},error:(e,t,s)=>{e?alert(e):alert(s)}})}render(){const e=["jet-engine-rels-modal"];return this.state.dataLoaded&&e.push("has-footer"),(0,s.jsxs)(se,{children:[(0,s.jsx)(ee,{isSecondary:!0,isSmall:!0,icon:X,onClick:()=>{this.fetchData(),this.setState({showModal:!0})},children:"Edit Meta"}),this.state.showModal&&(0,s.jsxs)(Z,{title:"Edit Meta",style:{width:"760px",maxWidth:"80vw"},className:e.join(" "),onRequestClose:e=>{e.target.classList.contains("is-nested-modal-trigger")||this.setState({showModal:!1,metaData:{},dataLoaded:!1})},children:[this.state.dataLoaded&&(0,s.jsx)(H,{...this.props,value:this.state.metaData,onUpdate:()=>{this.setState()}}),!this.state.dataLoaded&&(0,s.jsx)("div",{children:"Loading existing meta data..."})]})]})}},{SVG:ne,Path:re}=wp.components,ae=(0,s.jsxs)(ne,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[(0,s.jsx)("rect",{x:"0",fill:"none",width:"20",height:"20"}),(0,s.jsx)(re,{d:"M4 5H2v13h10v-2H4V5zm13.9-1.6l-1.3-1.3c-.4-.4-1.1-.5-1.6-.1l-1 1H5v12h9V9l4-4c.4-.5.3-1.2-.1-1.6zm-5.7 6l-2.5.9.9-2.5L15 3.4 16.6 5l-4.4 4.4z"})]}),{SVG:le,Path:ce}=wp.components,pe=(0,s.jsxs)(le,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[(0,s.jsx)("rect",{x:"0",fill:"none",width:"20",height:"20"}),(0,s.jsx)(ce,{d:"M18.3 9.5C15 4.9 8.5 3.8 3.9 7.2c-1.2.9-2.2 2.1-3 3.4.2.4.5.8.8 1.2 3.3 4.6 9.6 5.6 14.2 2.4.9-.7 1.7-1.4 2.4-2.4.3-.4.5-.8.8-1.2-.3-.4-.5-.8-.8-1.1zm-8.2-2.3c.5-.5 1.3-.5 1.8 0s.5 1.3 0 1.8-1.3.5-1.8 0-.5-1.3 0-1.8zm-.1 7.7c-3.1 0-6-1.6-7.7-4.2C3.5 9 5.1 7.8 7 7.2c-.7.8-1 1.7-1 2.7 0 2.2 1.7 4.1 4 4.1 2.2 0 4.1-1.7 4.1-4v-.1c0-1-.4-2-1.1-2.7 1.9.6 3.5 1.8 4.7 3.5-1.7 2.6-4.6 4.2-7.7 4.2z"})]}),{SVG:he,Path:de}=wp.components,me=(0,s.jsxs)(he,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[(0,s.jsx)("rect",{x:"0",fill:"none",width:"20",height:"20"}),(0,s.jsx)(de,{d:"M17.74 2.26c1.68 1.69 1.68 4.41 0 6.1l-1.53 1.52c-.32.33-.69.58-1.08.77L13 10l1.69-1.64.76-.77.76-.76c.84-.84.84-2.2 0-3.04-.84-.85-2.2-.85-3.04 0l-.77.76-.76.76L10 7l-.65-2.14c.19-.38.44-.75.77-1.07l1.52-1.53c1.69-1.68 4.42-1.68 6.1 0zM2 4l8 6-6-8zm4-2l4 8-2-8H6zM2 6l8 4-8-2V6zm7.36 7.69L10 13l.74 2.35-1.38 1.39c-1.69 1.68-4.41 1.68-6.1 0-1.68-1.68-1.68-4.42 0-6.1l1.39-1.38L7 10l-.69.64-1.52 1.53c-.85.84-.85 2.2 0 3.04.84.85 2.2.85 3.04 0zM18 16l-8-6 6 8zm-4 2l-4-8 2 8h2zm4-4l-8-4 8 2v2z"})]}),{SVG:ue,Path:je}=wp.components,we=(0,s.jsx)(ue,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,s.jsx)(je,{d:"M12 4h3c.6 0 1 .4 1 1v1H3V5c0-.6.5-1 1-1h3c.2-1.1 1.3-2 2.5-2s2.3.9 2.5 2zM8 4h3c-.2-.6-.9-1-1.5-1S8.2 3.4 8 4zM4 7h11l-.9 10.1c0 .5-.5.9-1 .9H5.9c-.5 0-.9-.4-1-.9L4 7z"})}),{Button:xe,Popover:ge}=wp.components,{Component:be,Fragment:ve}=wp.element,ye=class extends be{constructor(e){super(e),this.state={isTrash:!1,isDisconnect:!1}}processDisconnect(){window.wp.ajax.send("jet_engine_relations_disconnect_relation_items",{type:"POST",data:{_nonce:window.JetEngineRelationsCommon._nonce,relID:this.props.relID,relatedObjectID:this.props.relatedObjectID,relatedObjectType:this.props.relatedObjectType,relatedObjectName:this.props.relatedObjectName,currentObjectID:this.props.currentObjectID,isParentProcessed:this.props.isParentProcessed,isTrash:this.state.isTrash},success:e=>{this.cancelDisconnect(),this.props.onUpdate(e.related_list)},error:(e,t,s)=>{this.cancelDisconnect(),e?alert(e):alert(s)}})}cancelDisconnect(){this.setState({isTrash:!1,isDisconnect:!1})}confirmPopover(e){return e=e||window.JetEngineRelationsCommon.i18n.confirmText,(0,s.jsx)(ge,{position:"top center",noArrow:!1,onFocusOutside:()=>{this.cancelDisconnect()},children:(0,s.jsxs)("div",{style:{width:"100px",display:"flex",padding:"3px",justifyContent:"center",textAlign:"center",flexWrap:"wrap"},children:[e,(0,s.jsx)("a",{href:"#",style:{margin:"0 4px"},onClick:e=>{e.preventDefault(),e.stopPropagation(),this.processDisconnect()},children:window.JetEngineRelationsCommon.i18n.yes}),(0,s.jsx)("a",{href:"#",style:{margin:"0 4px"},onClick:e=>{e.preventDefault(),e.stopPropagation(),this.cancelDisconnect()},children:window.JetEngineRelationsCommon.i18n.no})]})})}render(){return(0,s.jsxs)("div",{className:"jet-engine-rels__actions-list",children:[this.props.actions.edit&&(0,s.jsx)(xe,{isSecondary:!0,isSmall:!0,icon:ae,onClick:()=>{window.open(this.props.actions.edit,"_blank").focus()},children:window.JetEngineRelationsCommon.i18n.edit}),this.props.actions.view&&(0,s.jsx)(xe,{isSecondary:!0,isSmall:!0,icon:pe,onClick:()=>{window.open(this.props.actions.view,"_blank").focus()},children:window.JetEngineRelationsCommon.i18n.view}),this.props.actions.disconnect&&(0,s.jsxs)(xe,{isSecondary:!0,isDestructive:!0,isSmall:!0,icon:me,onClick:()=>{this.setState({isTrash:!1,isDisconnect:!0})},children:[window.JetEngineRelationsCommon.i18n.disconnect,this.state.isDisconnect&&!this.state.isTrash&&this.confirmPopover()]}),this.props.actions.trash&&(0,s.jsxs)(xe,{isSecondary:!0,isDestructive:!0,isSmall:!0,icon:we,onClick:()=>{this.setState({isTrash:!0,isDisconnect:!0})},children:[window.JetEngineRelationsCommon.i18n.deleteItem,this.state.isDisconnect&&this.state.isTrash&&this.confirmPopover(window.JetEngineRelationsCommon.i18n.confirmDelete)]})]})}},{Button:_e}=wp.components,{Component:fe,Fragment:Ce}=wp.element,De=class extends fe{constructor(e){super(e)}hasMeta(){return this.props.metaFields&&0<this.props.metaFields.length}render(){const e=this.props.items.map((e=>{let t=e.columns.map(((e,t)=>(0,s.jsx)("td",{dangerouslySetInnerHTML:{__html:e}},"col_"+t)));return(0,s.jsxs)("tr",{children:[t,this.hasMeta()&&(0,s.jsx)("td",{className:"rel-meta",children:(0,s.jsx)(oe,{...this.props,relatedObjectID:e.related_id})}),(0,s.jsx)("td",{children:(0,s.jsx)(ye,{actions:e.actions,relID:this.props.relID,relatedObjectID:e.related_id,relatedObjectType:this.props.controlObjectType,relatedObjectName:this.props.controlObjectName,currentObjectID:this.props.currentObjectID,isParentProcessed:this.props.isParentProcessed,onUpdate:e=>{this.props.onUpdate(e)}})})]},"row_"+e._ID)})),t=this.props.columns.map((e=>(0,s.jsx)("th",{className:"rel-"+e.key,children:e.label},"rel-heading-"+e.key)));return(0,s.jsx)("div",{className:"jet-engine-rels__table-wrap",children:(0,s.jsxs)("table",{className:"wp-list-table widefat fixed striped table-view-list jet-engine-rels__table",children:[(0,s.jsx)("thead",{children:(0,s.jsx)("tr",{children:t})}),(0,s.jsxs)("tbody",{children:[0<this.props.items.length&&e,!this.props.items.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:this.props.columns.length,children:"--"})})]}),(0,s.jsx)("tfoot",{children:(0,s.jsx)("tr",{children:t})})]})})}},{Button:Se,ButtonGroup:Oe}=wp.components,{render:Ie,Component:Te,Fragment:Pe}=wp.element;class Me extends Te{constructor(e){super(e),this.state={connectNew:!1,createNew:!1,relatedID:null,relatedItems:[],allowedOptions:[]},this.fetchItems()}fetchItems(){window.wp.ajax.send("jet_engine_relations_get_related_items",{type:"GET",data:{_nonce:window.JetEngineRelationsCommon._nonce,relID:this.props.relID,objectType:this.props.controlObjectType,object:this.props.controlObjectName,currentObjectID:this.props.currentObjectID,isParentProcessed:this.props.isParentProcessed},success:e=>{this.setState({relatedItems:[...e]})},error:(e,t,s)=>{e?alert(e):alert(s)}})}buttonLabel(e){switch(e=e||"connect"){case"connect":return this.props.labels.connectButton;case"create":return this.props.labels.createButton}}modalTitle(){return this.state.connectNew?this.buttonLabel("connect"):this.state.createNew?this.buttonLabel("create"):null}closeModal(e){this.setState({createNew:!1,connectNew:!1}),e&&e.length&&this.setState({relatedItems:[...e]})}canCreate(){return this.props.createFields&&0<this.props.createFields.length}render(){return(0,s.jsxs)("div",{className:"jet-engine-rels",children:[(this.state.connectNew||this.state.createNew)&&(0,s.jsx)(Y,{...this.props,title:this.modalTitle(),relatedItems:this.state.relatedItems,type:this.state.connectNew?"connect":"create",onClose:e=>{e=e||!1,this.closeModal(e)},onComplete:e=>{e&&e.length?this.setState({relatedItems:[...e]}):this.setState({relatedItems:[]}),this.closeModal()}}),(0,s.jsxs)(Oe,{style:{display:"flex",gap:"10px"},children:[this.canCreate()&&(0,s.jsx)(Se,{isSecondary:!0,onClick:()=>{this.setState({createNew:!0,connectNew:!1})},children:this.buttonLabel("create")}),(0,s.jsx)(Se,{isSecondary:!0,onClick:()=>{this.setState({createNew:!1,connectNew:!0})},children:this.buttonLabel("connect")})]}),(0,s.jsx)(De,{items:this.state.relatedItems,columns:this.props.tableColumns,metaFields:this.props.metaFields,relID:this.props.relID,currentObjectID:this.props.currentObjectID,controlObjectType:this.props.controlObjectType,controlObjectName:this.props.controlObjectName,isParentProcessed:this.props.isParentProcessed,onUpdate:e=>{this.setState({relatedItems:[...e]})}})]})}}for(var Be=0;Be<window.JetEngineRelationsControls.length;Be++){let e=window.JetEngineRelationsControls[Be];const t=document.getElementById(e.relEl);t&&Ie((0,s.jsx)(Me,{relID:e.relID,metaFields:e.metaFields,labels:e.labels,tableColumns:e.tableColumns,currentObjectID:window.JetEngineCurrentObjectID,controlObjectType:e.objectType,controlObjectName:e.object,isParentProcessed:e.isParentProcessed,createFields:e.createFields}),t)}})();
//# sourceMappingURL=admin-controls.js.map